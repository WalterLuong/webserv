# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: mlormois <mlormois@student.42.fr>          +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2022/01/18 18:53:23 by jdidier           #+#    #+#              #
#    Updated: 2022/07/05 10:52:42 by mlormois         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

NAME		= webserv

SRCS			= 	main.cpp \
				srcs/Socket.cpp \
				srcs/Server.cpp \
				srcs/Service.cpp \
				srcs/parsing_conffile.cpp \
				srcs/parsing_server.cpp \
				srcs/parsing_request.cpp \
				srcs/utils_parsing.cpp \
				srcs/parsing.cpp \
				srcs/Response.cpp \
				srcs/ResponseHeader.cpp \
				srcs/utils.cpp			\
				srcs/cgi.cpp

INCLUDE		=	-I./includes/

OBJS	= $(SRCS:%.cpp=$(BIN)/%.o)

DEP = $(OBJS:%.o=%.d)

BIN		= ./bin

CXX	= clang++

CXXFLAGS = -Wall -Werror -Wextra -std=c++98

RM = rm -f

AUDIO = ~/Downloads/hearthstone-heroes-of-warcraft-travail-termine.wav

all: $(NAME)

$(NAME):	$(OBJS)
	@clear
	@echo "\033[1;95m██\033[m╗    \033[1;95m██\033[m╗\033[1;95m███████\033[m╗\033[1;95m██████\033[m╗ \033[1;95m███████\033[m╗\033[1;95m███████\033[m╗\033[1;95m██████\033[m╗ \033[1;95m██\033[m╗   \033[1;95m██\033[m╗"
	@echo "\033[1;95m██\033[m║    \033[1;95m██\033[m║\033[1;95m██\033[m╔════╝\033[1;95m██\033[m╔══\033[1;95m██\033[m╗\033[1;95m██\033[m╔════╝\033[1;95m██\033[m╔════╝\033[1;95m██\033[m╔══\033[1;95m██\033[m╗\033[1;95m██\033[m║   \033[1;95m██\033[m║"
	@echo "\033[1;95m██\033[m║ \033[1;95m█\033[m╗ \033[1;95m██\033[m║\033[1;95m█████\033[m╗  \033[1;95m██████\033[m╔╝\033[1;95m███████\033[m╗\033[1;95m█████\033[m╗  \033[1;95m██████\033[m╔╝\033[1;95m██\033[m║   \033[1;95m██\033[m║"
	@echo "\033[1;95m██\033[m║\033[1;95m███\033[m╗\033[1;95m██\033[m║\033[1;95m██\033[m╔══╝  \033[1;95m██\033[m╔══\033[1;95m██\033[m╗╚════\033[1;95m██\033[m║\033[1;95m██\033[m╔══╝  \033[1;95m██\033[m╔══\033[1;95m██\033[m╗╚\033[1;95m██\033[m╗ \033[1;95m██\033[m╔╝"
	@echo "╚\033[1;95m███\033[m╔\033[1;95m███\033[m╔╝\033[1;95m███████\033[m╗\033[1;95m██████\033[m╔╝\033[1;95m███████\033[m║\033[1;95m███████\033[m╗\033[1;95m██\033[m║  \033[1;95m██\033[m║ ╚\033[1;95m████\033[m╔╝ "
	@echo " ╚══╝╚══╝ ╚══════╝╚═════╝ ╚══════╝╚══════╝╚═╝  ╚═╝  ╚═══╝  "
	@echo "\033[3;95mMade by Wluong & Viporten 🛠️\n\n\033[m"
	@echo "▄▄▄▄▄▄▄ ▄▄▄ ▄▄ ▄▄   ▄ ▄▄▄▄▄▄▄	▄▄▄▄▄▄▄ ▄ ▄ ▄ ▄ ▄  ▄  ▄▄▄▄▄▄▄" 
	@echo "█ ▄▄▄ █ █▀█▄ ▀▄▄ ▄ ██ █ ▄▄▄ █	█ ▄▄▄ █ ▄██▀▀▄▀ █▀▀ █ █ ▄▄▄ █"
	@echo "█ ███ █ ▀▀ ▀ ▀█▄█  ▀▄ █ ███ █	█ ███ █ █▀▀▄███▄▄███▄ █ ███ █"
	@echo "█▄▄▄▄▄█ █ ▄▀█ ▄ █▀█▀▄ █▄▄▄▄▄█	█▄▄▄▄▄█ ▄ █▀▄ █ █▀▄▀█ █▄▄▄▄▄█"
	@echo "▄▄  ▄▄▄  ▀ ▄▀ ▀ ▄█▄▄▄  ▄ ▄▄▄▄	▄▄▄▄  ▄ ▄ █▄█ ▄▀▀█ ▄▀▄  ▄▄▄ ▄"
	@echo "▄ ▄▄▄▄▄▄▄▀▀▄█▄██▀▀█  ▄▀██▀▀▀█	█▀▄█▄ ▄ ▀▄█▄█▄█ █▀█▀█▀███ ▄▄▀"
	@echo "█▄  █ ▄ ▀ █▀▄  ▄ █ █ ▄▀  ▀ █▀	█▀ █▀▀▄▄ ██ ▄█▄▀ ▄  ▄▀▀▀ ▄▄ ▀"
	@echo "█ ▄▀▀█▄█ █   ███  █   ▀▀███▀█	▄██▀ ▀▄▄█▄▄█▀▄▄▀ █▄█ ▄▀▄▄ ███"
	@echo "▀█▄▄▀█▄▀▀ ▄▄▀▄█ ██ ▄▀█▀ ▀  █▀	▀ ▄██ ▄▄▀▄▄▀▄▄  ▄ █ ▀█ █▄▄ █ "
	@echo "▄▄▄▀▄▄▄█▄▄▄▀▄█  ██▄▀█▄██▄▄ ▀█	▄▀▄█ █▄▀▄▄▀  ▀▄█ ▄█ ▀  ▀ ▀█▀ "
	@echo "▄▄▄▄▄▄▄ ▀██  ▀▀█▀▀███ ▄ █▄▄ █	 ▄▄▄▀▀▄██▀▀▀  ▄▀ █ ▀▄█▄█▄▄█  "
	@echo "█ ▄▄▄ █ █▄ ▄▀▄█▀ █▀██▄▄▄█▄ ▀█	▄▄▄▄▄▄▄ ▀▀█  █  █▀█▄█ ▄ ██▀█▀"
	@echo "█ ███ █  ▄▄▄█▄▄█▀▄▄ █▄ ▀ ▄▄▄█	█ ▄▄▄ █    █▀▀ ▄ ▄▀ █▄▄▄█▀▄▄▄"
	@echo "█▄▄▄▄▄█ ███▀▄█  ██▀ █ ▄▀▄▀ █▀	█ ███ █ █▄█▀▄▀█▀▀▀███  ▄▀▀▄ █"
	@echo "                                █▄▄▄▄▄█ █▄▀▄▀▀  ▄ ▄▄█ █▄▀█ █ \n\n"
	
	@echo "\n\033[1;33mCompilation de Webserv \033[5m⌛\033[0;m\n"
	@mkdir -p $(@D)
	@$(CXX) $(CXXFLAGS) $^ -o $@ -I $(INCLUDE)
	@bash ../.script.sh
	@echo
	@echo "\033[1;32mCOMPILATION TERMINÉE ✓\n\033[0;m"
	@echo "\n\033[3;34mVous pouvez lancez \033[1;4m./webserv\033[m \033[3;34m!\n\033[0;m"
	@echo "\n Vous pouvez faire \"make subject\" pour récuperer le sujet.\n"
	@if [ -e $(AUDIO) ]; then \
		paplay $(AUDIO); \
	fi

-include $(DEP)
	
$(BIN)/%.o:		%.cpp
	@mkdir -p $(@D)
	@$(CXX) $(CXXFLAGS) -MMD -o $@ -c $<



clean:
	@$(RM) $(BIN)/$(OBJS)
	@echo "\033[5;1;32mCLEANED\033[m"
	@echo "\033[5;1;32m     _____\    _______		\033[m"
	@echo "\033[5;1;32m   /      \  |      /\		\033[m"
	@echo "\033[5;1;32m  /_______/  |_____/  \	\033[m"
	@echo "\033[5;1;32m |   \   /        /   /	\033[m"
	@echo "\033[5;1;32m  \   \         \/   /		\033[m"
	@echo "\033[5;1;32m   \  /          \__/_		\033[m"
	@echo "\033[5;1;32m    \/ ____    /\			\033[m"
	@echo "\033[5;1;32m      /  \    /  \			\033[m"
	@echo "\033[5;1;32m     /\   \  /   /			\033[m"
	@echo "\033[5;1;32m       \   \/   /			\033[m"
	@echo "\033[5;1;32m        \___\__/			\033[m"

fclean:	clean
	@$(RM) $(NAME)
	@if [ -e $(BIN) ]; then \
		rm -r $(BIN); \
	fi
	
re:	fclean $(NAME)

love:
	@echo "\n\n"
	@echo "\033[1;31m        @@@@@@           @@@@@@"
	@echo "\033[1;31m      @@@@@@@@@@       @@@@@@@@@@"
	@echo "\033[1;31m    @@@@@@@@@@@@@@   @@@@@@@@@@@@@@"
	@echo "\033[1;31m  @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m      @@@@@@@@@@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m        @@@@@@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m          @@@@@@@@@@@@@@@@@@@"
	@echo "\033[1;31m            @@@@@@@@@@@@@@@"
	@echo "\033[1;31m              @@@@@@@@@@@"
	@echo "\033[1;31m                @@@@@@@"
	@echo "\033[1;31m                  @@@"
	@echo "\033[1;31m                   @\033[m"
	@echo "\n\n"

subject:
	@curl -Ls -o /dev/null -w %{url_effective} https://cdn.intra.42.fr/pdf/pdf/35062/en.subject.pdf

star wars:
	telnet towel.blinkenlights.nl

.PHONY: all clean fclean re subject love